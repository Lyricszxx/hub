local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local espEnabled = false

-- Criar interface do usuário
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ESPGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

local toggleESPButton = Instance.new("TextButton")
toggleESPButton.Size = UDim2.new(0, 100, 0, 50)
toggleESPButton.Position = UDim2.new(1, -110, 0, 70)
toggleESPButton.AnchorPoint = Vector2.new(1, 0)
toggleESPButton.Text = "ESP: OFF"
toggleESPButton.Parent = screenGui

-- Função para criar ou atualizar o ESP para um jogador
local function updateESP(player)
    if player == Players.LocalPlayer then return end

    local character = player.Character
    if not character then return end

    local highlight = character:FindFirstChild("Highlight")
    if not highlight then
        highlight = Instance.new("Highlight")
        highlight.Parent = character
    end

    highlight.Enabled = espEnabled
    highlight.FillColor = Color3.new(1, 0, 0)  -- Cor vermelha para inimigos
    highlight.OutlineColor = Color3.new(1, 0, 0)  -- Contorno branco
    highlight.FillTransparency = 1
    highlight.OutlineTransparency = 0
end

-- Função para atualizar o ESP para todos os jogadores
local function updateAllESP()
    for _, player in pairs(Players:GetPlayers()) do
        updateESP(player)
    end
end

-- Função para alternar o ESP
local function toggleESP()
    espEnabled = not espEnabled
    toggleESPButton.Text = "ESP: " .. (espEnabled and "ON" or "OFF")
    updateAllESP()
end

-- Conectar o botão à função de alternância
toggleESPButton.TouchTap:Connect(toggleESP)

-- Atualizar o ESP a cada quadro
RunService.RenderStepped:Connect(updateAllESP)

-- Atualizar o ESP quando um novo jogador entra no jogo
Players.PlayerAdded:Connect(updateESP)

-- Inicialização
updateAllESP()
